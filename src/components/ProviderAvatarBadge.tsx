import { BadgeInfo } from "lucide-react";

interface ProviderAvatarBadgeProps {
  imageUrl?: string | null;
  isVerified?: boolean;
  createdAt?: string | null;
  size?: number;
  alt?: string;
  className?: string;
}

const ProviderAvatarBadge = ({
  imageUrl,
  isVerified = false,
  createdAt,
  size = 80,
  alt = "Provider Avatar",
  className = "",
}: ProviderAvatarBadgeProps) => {
  
  const isNewProvider = (createdAt?: string | null): boolean => {
    if (!createdAt) return false;
    const created = new Date(createdAt);
    const daysDiff = (Date.now() - created.getTime()) / (1000 * 60 * 60 * 24);
    return daysDiff < 15;
  };

  const isNew = isNewProvider(createdAt);

  // NEW Badge SVG for new providers
  const StarburstIcon = () => (
    <svg
      viewBox="0 0 512 512"
      className="w-full h-full"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path 
        style={{ fill: "#507C5C" }} 
        d="M459.796,334.815c-3.191,0-6.412-0.974-9.188-2.994c-6.981-5.081-8.521-14.86-3.44-21.841 c4.004-5.502,4.67-15.323,5.375-25.721c0.63-9.288,1.28-18.892,4.32-28.246c2.922-8.999,7.947-16.922,12.806-24.583 c5.689-8.969,11.063-17.441,11.063-24.794c0-7.353-5.375-15.823-11.063-24.791c-4.859-7.662-9.885-15.586-12.807-24.588 c-3.036-9.352-3.687-18.956-4.318-28.245c-0.704-10.397-1.371-20.22-5.375-25.72c-4.084-5.613-13.272-9.284-22.999-13.169 c-8.607-3.438-17.505-6.993-25.387-12.729c-7.778-5.661-13.836-12.972-19.694-20.043c-6.727-8.117-13.079-15.786-19.829-17.976 c-6.25-2.029-15.689,0.344-25.679,2.856c-9.152,2.303-18.619,4.682-28.67,4.682c-10.053,0-19.518-2.38-28.671-4.682 c-9.992-2.512-19.43-4.887-25.677-2.856c-6.748,2.19-13.101,9.859-19.827,17.976c-5.858,7.07-11.916,14.382-19.696,20.043 c-6.982,5.08-16.76,3.54-21.841-3.441s-3.54-16.76,3.441-21.841c4.604-3.352,9.177-8.869,14.017-14.712 c8.844-10.675,18.869-22.773,34.248-27.766c14.807-4.806,29.764-1.046,42.961,2.273c7.645,1.921,14.865,3.738,21.045,3.738 c6.179,0,13.398-1.817,21.043-3.738c13.197-3.319,28.155-7.079,42.961-2.273c15.379,4.994,25.404,17.093,34.248,27.766 c4.84,5.842,9.413,11.36,14.017,14.712c4.715,3.432,11.452,6.124,18.587,8.974c12.792,5.111,27.291,10.903,36.681,23.808 c9.309,12.79,10.361,28.31,11.289,42.004c0.525,7.729,1.019,15.031,2.861,20.704c1.704,5.244,5.477,11.194,9.473,17.493 c7.465,11.768,15.928,25.108,15.928,41.54s-8.461,29.772-15.928,41.543c-3.996,6.299-7.769,12.248-9.473,17.491 c-1.842,5.674-2.336,12.975-2.861,20.704c-0.929,13.694-1.981,29.215-11.291,42.007 C469.389,332.584,464.626,334.815,459.796,334.815z" 
      />
      <path 
        style={{ fill: "#CFF09E" }} 
        d="M398.54,305.356c0,19.785-18.837,36.352-24.635,54.205c-6.008,18.503-0.713,42.937-11.921,58.339 c-11.321,15.554-36.271,18.017-51.827,29.337c-15.401,11.208-25.391,34.242-43.894,40.248c-17.853,5.797-39.392-6.776-59.176-6.776 s-41.324,12.571-59.176,6.776c-18.503-6.008-28.493-29.04-43.894-40.248c-15.554-11.321-40.506-13.783-51.827-29.337 c-11.208-15.401-5.914-39.836-11.921-58.339c-5.797-17.852-24.635-34.42-24.635-54.205s18.837-36.352,24.635-54.205 c6.008-18.503,0.713-42.937,11.921-58.339c11.321-15.554,36.271-18.017,51.827-29.337c15.401-11.208,25.391-34.242,43.894-40.248 c17.853-5.797,39.392,6.776,59.176,6.776s41.324-12.571,59.176-6.776c18.503,6.008,28.493,29.04,43.894,40.248 c15.554,11.321,40.506,13.783,51.827,29.337c11.208,15.401,5.914,39.836,11.921,58.339 C379.703,269.003,398.54,285.571,398.54,305.356z" 
      />
      <g>
        <path 
          style={{ fill: "#507C5C" }} 
          d="M158.298,504.648c-5.489,0-10.467-0.749-15.215-2.292c-15.379-4.994-25.404-17.093-34.248-27.766 c-4.84-5.842-9.413-11.361-14.018-14.712c-4.717-3.432-11.454-6.124-18.587-8.974c-12.792-5.111-27.291-10.903-36.681-23.806 c-9.309-12.79-10.361-28.312-11.289-42.006c-0.524-7.729-1.019-15.031-2.861-20.704c-1.703-5.244-5.477-11.192-9.471-17.491 C8.461,335.129,0,321.789,0,305.356s8.461-29.772,15.926-41.541c3.996-6.297,7.769-12.248,9.471-17.491 c1.843-5.675,2.337-12.976,2.863-20.707c0.929-13.692,1.981-29.214,11.289-42.004c9.39-12.903,23.889-18.695,36.681-23.806 c7.134-2.85,13.872-5.541,18.587-8.972c4.604-3.352,9.177-8.869,14.017-14.712c8.844-10.675,18.869-22.773,34.248-27.766 c4.75-1.542,9.726-2.292,15.215-2.292c9.599,0,18.825,2.32,27.746,4.564c7.643,1.921,14.863,3.738,21.043,3.738 c6.18,0,13.4-1.817,21.043-3.74c8.922-2.243,18.146-4.564,27.746-4.564c5.489,0,10.464,0.749,15.212,2.29 c15.379,4.994,25.404,17.093,34.248,27.766c4.842,5.842,9.413,11.361,14.019,14.713c4.717,3.432,11.454,6.124,18.587,8.974 c12.792,5.111,27.291,10.903,36.681,23.804c9.309,12.792,10.362,28.312,11.289,42.006c0.525,7.729,1.019,15.031,2.861,20.706 c1.704,5.244,5.477,11.192,9.473,17.491c7.465,11.769,15.928,25.11,15.928,41.543c0,16.433-8.461,29.772-15.928,41.543 c-3.996,6.297-7.769,12.248-9.473,17.491c-1.842,5.672-2.336,12.973-2.859,20.703c-0.929,13.694-1.981,29.215-11.289,42.007 c-9.391,12.903-23.889,18.695-36.682,23.806c-7.134,2.85-13.871,5.541-18.586,8.974c-4.606,3.352-9.179,8.871-14.021,14.713 c-8.843,10.673-18.867,22.771-34.246,27.765c-4.748,1.542-9.726,2.292-15.214,2.292c-9.599,0-18.825-2.32-27.746-4.564 c-7.644-1.921-14.863-3.738-21.043-3.738c-6.18,0-13.4,1.817-21.045,3.738C177.121,502.328,167.897,504.648,158.298,504.648z M158.296,137.333c-2.159,0-3.977,0.25-5.559,0.763c-6.748,2.19-13.101,9.859-19.827,17.976 c-5.858,7.07-11.916,14.382-19.696,20.043c-7.881,5.735-16.778,9.29-25.385,12.728c-9.728,3.887-18.917,7.558-22.999,13.169 c-4.004,5.502-4.67,15.323-5.375,25.721c-0.63,9.288-1.28,18.892-4.318,28.248c-2.922,8.999-7.947,16.922-12.806,24.583 c-5.689,8.969-11.063,17.441-11.063,24.793c0,7.353,5.373,15.825,11.063,24.794c4.859,7.661,9.885,15.582,12.807,24.583 c3.036,9.354,3.688,18.958,4.318,28.246c0.705,10.398,1.37,20.22,5.375,25.721c4.084,5.611,13.272,9.282,22.999,13.169 c8.607,3.438,17.505,6.993,25.385,12.729c7.78,5.661,13.838,12.973,19.696,20.044c6.726,8.117,13.079,15.784,19.827,17.976 c1.582,0.514,3.399,0.763,5.558,0.763c5.728,0,12.718-1.759,20.118-3.619c9.154-2.301,18.62-4.682,28.671-4.682 s19.518,2.38,28.671,4.682c7.401,1.86,14.391,3.619,20.119,3.619c2.159,0,3.977-0.25,5.559-0.763 c6.746-2.19,13.1-9.857,19.826-17.974c5.86-7.071,11.918-14.383,19.699-20.046c7.88-5.735,16.777-9.29,25.383-12.728 c9.729-3.887,18.917-7.556,23.001-13.169c4.004-5.502,4.668-15.323,5.375-25.723c0.628-9.287,1.28-18.891,4.317-28.243 c2.924-9.001,7.948-16.924,12.807-24.585c5.689-8.969,11.063-17.441,11.063-24.794c0-7.353-5.375-15.825-11.063-24.794 c-4.859-7.661-9.884-15.582-12.806-24.583c-3.038-9.354-3.688-18.959-4.32-28.248c-0.704-10.397-1.37-20.22-5.375-25.72 c-4.082-5.611-13.27-9.282-22.999-13.169c-8.607-3.438-17.504-6.993-25.385-12.728c-7.78-5.661-13.838-12.973-19.697-20.044 c-6.726-8.117-13.078-15.786-19.827-17.976c-1.582-0.514-3.399-0.763-5.558-0.763c-5.728,0-12.718,1.759-20.119,3.619 c-9.154,2.303-18.62,4.684-28.671,4.684c-10.053,0-19.518-2.381-28.671-4.684C171.015,139.091,164.025,137.333,158.296,137.333z" 
        />
        <path 
          style={{ fill: "#507C5C" }} 
          d="M150.775,268.863c-6.161,0-10.301,2.869-10.301,7.139v25.16l-12.101-23.079 c-4.137-7.947-6.938-9.219-13.811-9.219c-6.161,0-10.301,2.91-10.301,7.242v64.775c0,4.263,4.235,7.242,10.301,7.242 c6.066,0,10.301-2.978,10.301-7.242v-25.54l14.976,27.27c2.652,4.884,7.237,5.509,10.936,5.509c6.066,0,10.301-2.978,10.301-7.242 v-64.875C161.076,271.732,156.936,268.863,150.775,268.863z" 
        />
        <path 
          style={{ fill: "#507C5C" }} 
          d="M213.002,287.427c4.202,0,7.139-3.858,7.139-9.384c0-5.405-2.936-9.18-7.139-9.18h-36.315 c-5.378,0-9.282,3.046-9.282,7.242v64.775c0,4.196,3.904,7.242,9.282,7.242h36.315c4.202,0,7.139-3.776,7.139-9.18 c0-5.525-2.936-9.384-7.139-9.384h-24.993v-12.651h12.956c4.687,0,7.139-4.207,7.139-8.364c0-4.964-3.002-8.567-7.139-8.567 h-12.956v-12.549h24.993V287.427z" 
        />
        <path 
          style={{ fill: "#507C5C" }} 
          d="M308.721,268.863c-3.827,0-6.508,1.698-7.348,4.637l-12.99,43.838l-6.036-25.829 c-0.924-4.157-5.658-6.019-9.939-6.019c-4.281,0-9.016,1.86-9.934,5.994l-6.043,25.854l-12.983-43.816 c-0.846-2.961-3.525-4.659-7.356-4.659c-5.281,0-12.648,3.299-12.648,8.669c0,0.683,0.12,1.454,0.319,2.053l20.291,62.2 c1.327,4.22,6.329,6.946,12.745,6.946c5.455,0,11.464-2.204,12.595-7.148l3.014-13.736l3.021,13.756 c1.124,4.923,7.132,7.128,12.589,7.128c6.393,0,11.269-2.639,12.736-6.923l20.295-62.208c0.203-0.61,0.325-1.384,0.325-2.07 C321.371,272.162,314.004,268.863,308.721,268.863z" 
        />
      </g>
    </svg>
  );

  // Verified Badge SVG for verified providers
  const VerifiedBadgeIcon = () => (
    <svg
      viewBox="0 0 501.55 501.55"
      className="w-full h-full"
      xmlns="http://www.w3.org/2000/svg"
    >
      <g>
        <polygon style={{ fill: "#40596B" }} points="480.653,414.825 399.151,427.363 360.49,501.551 299.886,417.959 257.045,358.4 376.163,271.673 431.543,347.951" />
        <polygon style={{ fill: "#40596B" }} points="244.506,358.4 201.665,416.914 141.061,501.551 102.4,427.363 20.898,414.825 70.008,346.906 125.388,271.673" />
      </g>
      <g>
        <path style={{ fill: "#334A5E" }} d="M125.388,271.673l119.118,87.771l-42.841,58.514c-2.09-1.045-3.135-2.09-4.18-2.09 c-1.045,0-2.09,0-3.135,0c-4.18,0-10.449,1.045-16.718,2.09c-7.314,2.09-14.629,3.135-22.988,3.135 c-7.314,0-14.629-1.045-19.853-5.224c-13.584-8.359-18.808-22.988-22.988-36.571c-2.09-7.314-5.224-14.629-7.314-17.763 c-3.135-3.135-10.449-5.224-17.763-7.314c-5.224-2.09-11.494-4.18-16.718-6.269L125.388,271.673z" />
        <path style={{ fill: "#334A5E" }} d="M431.543,347.951c-5.224,3.135-11.494,4.18-16.718,6.269c-7.314,2.09-14.629,5.224-17.763,7.314 c-3.135,3.135-5.224,10.449-8.359,17.763c-4.18,13.584-9.404,28.212-22.988,36.571c-5.224,3.135-12.539,5.224-19.853,5.224 c-7.314,0-15.673-1.045-22.988-3.135c-6.269-1.045-11.494-2.09-16.718-2.09c-1.045,0-2.09,0-3.135,0s-3.135,1.045-5.224,2.09 l-42.841-58.514l119.118-87.771L431.543,347.951z" />
      </g>
      <path style={{ fill: "#895fc8" }} d="M466.024,215.249c0,17.763-26.122,32.392-31.347,49.11c-4.18,17.763,10.449,42.841,2.09,58.514 c-9.404,15.673-38.661,14.629-51.2,27.167s-11.494,42.841-27.167,51.2s-40.751-6.269-58.514-2.09 c-16.718,4.18-31.347,31.347-49.11,31.347s-32.392-26.122-49.11-31.347c-17.763-4.18-42.841,10.449-58.514,2.09 c-15.673-9.404-14.629-38.661-27.167-51.2c-12.539-12.539-42.841-11.494-51.2-27.167c-8.359-15.673,6.269-40.751,2.09-58.514 c-4.18-16.718-31.347-31.347-31.347-49.11s26.122-32.392,31.347-49.11c4.18-17.763-10.449-42.841-2.09-58.514 c9.404-15.673,38.661-14.629,51.2-27.167c12.539-12.539,11.494-42.841,27.167-51.2s40.751,6.269,58.514,2.09 C218.384,27.167,233.012,0,250.776,0s32.392,26.122,49.11,31.347c17.763,4.18,42.841-10.449,58.514-2.09 c15.673,9.404,14.629,38.661,27.167,51.2c12.539,12.539,42.841,11.494,51.2,27.167s-6.269,40.751-2.09,58.514 C439.902,182.857,466.024,197.486,466.024,215.249z" />
      <path style={{ fill: "#FFFFFF" }} d="M250.776,397.061c-2.09-2.09-4.18-4.18-6.269-5.224c-8.359-8.359-19.853-17.763-34.482-21.943 c-5.224-1.045-10.449-2.09-15.673-2.09c-9.404,0-18.808,2.09-26.122,3.135c-2.09,1.045-5.224,1.045-7.314,1.045 c-1.045-2.09-2.09-5.224-2.09-7.314c-4.18-11.494-8.359-26.122-19.853-36.571c-11.494-11.494-25.078-15.673-36.571-19.853 c-3.135,0-6.269-1.045-8.359-2.09c0-2.09,1.045-5.224,1.045-7.314c2.09-11.494,5.224-26.122,2.09-41.796 c-4.18-14.629-13.584-26.122-21.943-34.482c-2.09-2.09-4.18-4.18-5.224-6.269c2.09-2.09,4.18-4.18,5.224-6.269 c8.359-8.359,17.763-19.853,21.943-34.482c4.18-15.673,1.045-30.302-2.09-41.796c0-2.09-1.045-5.224-1.045-7.314 c2.09-1.045,5.224-2.09,7.314-2.09c11.494-4.18,26.122-8.359,36.571-19.853C149.42,92.996,153.6,79.412,157.78,67.918 c1.045-2.09,2.09-5.224,2.09-7.314c2.09,0,5.224,1.045,7.314,1.045c7.314,2.09,16.718,3.135,26.122,3.135 c5.224,0,10.449-1.045,15.673-2.09c15.673-5.224,26.122-14.629,35.527-22.988c2.09-2.09,4.18-4.18,6.269-5.224 c2.09,2.09,4.18,4.18,6.269,5.224c9.404,8.359,19.853,17.763,35.527,21.943c5.224,1.045,10.449,2.09,15.673,2.09 c9.404,0,18.808-2.09,26.122-3.135c2.09-1.045,5.224-1.045,7.314-1.045c1.045,2.09,2.09,5.224,2.09,7.314 c4.18,11.494,8.359,26.122,19.853,36.571c11.494,11.494,25.078,15.673,36.571,19.853c2.09,1.045,5.224,2.09,7.314,2.09 c0,2.09-1.045,5.224-1.045,7.314c-2.09,11.494-5.224,26.122-2.09,41.796c4.18,14.629,13.584,26.122,21.943,34.482 c2.09,2.09,4.18,4.18,5.224,6.269c-2.09,2.09-4.18,4.18-5.224,6.269c-8.359,8.359-17.763,19.853-21.943,34.482 c-4.18,15.673-1.045,30.302,2.09,41.796c0,2.09,1.045,5.224,1.045,7.314c-2.09,2.09-5.225,3.135-7.314,3.135 c-11.494,4.18-26.122,8.359-36.571,19.853c-11.494,11.494-15.673,25.078-19.853,36.571c-1.045,2.09-2.09,5.224-2.09,7.314 c-2.09,0-5.224-1.045-7.314-1.045c-7.314-2.09-16.718-3.135-26.122-3.135c-5.224,0-10.449,1.045-15.673,2.09 c-14.629,4.18-26.122,13.584-34.482,21.943C254.955,392.882,252.865,394.971,250.776,397.061z" />
      <polygon style={{ fill: "#895fc8" }} points="362.58,190.171 285.257,178.678 250.776,109.714 216.294,178.678 138.971,190.171 195.396,244.506 181.812,321.829 250.776,285.257 319.739,321.829 306.155,244.506" />
    </svg>
  );

  return (
    <div
      className={`relative inline-block ${className}`}
      style={{ width: size, height: size }}
      role="img"
      aria-label={`${alt}${isNew ? " - New Provider" : isVerified ? " - Verified" : ""}`}
    >
      {/* Avatar Container */}
      <div className="w-full h-full rounded-full overflow-hidden border-4 border-white shadow-md bg-gray-100">
        {imageUrl ? (
          <img
            src={imageUrl}
            alt={alt}
            className="w-full h-full object-cover"
            onError={(e) => {
              (e.target as HTMLImageElement).src = "/placeholder.svg";
            }}
          />
        ) : (
          <div className="w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200">
            <svg
              className="w-1/2 h-1/2 text-gray-400"
              fill="currentColor"
              viewBox="0 0 24 24"
            >
              <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
            </svg>
          </div>
        )}
      </div>

      {/* Badge Icon at bottom-right */}
      <div 
        className="absolute bottom-0 right-0 translate-x-1/4 translate-y-1/4 bg-white rounded-full shadow-sm flex items-center justify-center"
        style={{ 
          width: size * 0.42, 
          height: size * 0.42,
          padding: size * 0.04
        }}
      >
        {isNew ? (
          <div className="text-black w-full h-full">
            <StarburstIcon />
          </div>
        ) : isVerified ? (
          <div className="w-full h-full">
            <VerifiedBadgeIcon />
          </div>
        ) : (
          <BadgeInfo 
            size={size * 0.27} 
            color="#005f6b" 
            strokeWidth={1.5} 
          />
        )}
      </div>
    </div>
  );
};

export default ProviderAvatarBadge;
